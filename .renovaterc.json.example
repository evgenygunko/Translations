// Alternative Renovate configuration with detailed comments
// Rename this file to 'renovate.json' if you prefer this configuration
{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  
  // Extend recommended configuration presets
  "extends": [
    "config:recommended",
    ":dependencyDashboard",
    ":semanticCommits",
    ":timezone(UTC)"
  ],
  
  // Azure DevOps specific settings
  "platform": "azure",
  "endpoint": "https://dev.azure.com/evgenyg/",
  
  // Enable onboarding PR for first-time setup
  "onboarding": true,
  "onboardingConfig": {
    "extends": ["config:recommended"]
  },
  
  // Dependency Dashboard - single issue showing all updates
  "dependencyDashboard": true,
  "dependencyDashboardTitle": "ðŸ¤– Renovate Dependency Dashboard",
  "dependencyDashboardHeader": "This dashboard shows all pending updates managed by Renovate.",
  "dependencyDashboardFooter": "Configure Renovate by editing renovate.json in the repository root.",
  
  // Enable managers for different package types
  "enabledManagers": [
    "nuget",      // .csproj files
    "npm",        // package.json
    "dockerfile"  // Dockerfile
  ],
  
  // Package-specific rules
  "packageRules": [
    // === NuGet Package Rules ===
    {
      "description": "Group minor/patch NuGet updates",
      "matchManagers": ["nuget"],
      "matchUpdateTypes": ["minor", "patch"],
      "groupName": "NuGet dependencies (non-major)",
      "schedule": ["before 6am on Monday"]
    },
    {
      "description": "Major NuGet updates - require review",
      "matchManagers": ["nuget"],
      "matchUpdateTypes": ["major"],
      "groupName": "NuGet dependencies (major)",
      "labels": ["major-update", "nuget", "requires-review"],
      "automerge": false
    },
    {
      "description": "Microsoft packages - separate group",
      "matchManagers": ["nuget"],
      "matchPackagePatterns": ["^Microsoft\\..*"],
      "groupName": "Microsoft NuGet packages"
    },
    {
      "description": "Test framework packages",
      "matchManagers": ["nuget"],
      "matchPackagePatterns": ["^xunit", "^Moq", "^FluentAssertions", "^coverlet"],
      "groupName": "Test framework packages",
      "automerge": true,
      "automergeType": "pr"
    },
    
    // === npm Package Rules ===
    {
      "description": "Group minor/patch npm updates",
      "matchManagers": ["npm"],
      "matchUpdateTypes": ["minor", "patch"],
      "groupName": "npm dependencies (non-major)"
    },
    {
      "description": "Major npm updates - require review",
      "matchManagers": ["npm"],
      "matchUpdateTypes": ["major"],
      "groupName": "npm dependencies (major)",
      "labels": ["major-update", "npm", "requires-review"]
    },
    {
      "description": "Auto-merge npm devDependencies",
      "matchManagers": ["npm"],
      "matchDepTypes": ["devDependencies"],
      "matchUpdateTypes": ["minor", "patch"],
      "automerge": true,
      "automergeType": "pr"
    },
    {
      "description": "Prettier tooling",
      "matchPackageNames": ["prettier", "pretty-quick"],
      "groupName": "Prettier",
      "automerge": true
    },
    
    // === Docker Rules ===
    {
      "description": "Docker base images",
      "matchManagers": ["dockerfile"],
      "groupName": "Docker base images",
      "labels": ["docker"]
    },
    
    // === Security Rules ===
    {
      "description": "High priority security updates",
      "matchUpdateTypes": ["patch"],
      "matchCurrentVersion": "!/^0/",
      "vulnerabilitySeverity": ["high", "critical"],
      "labels": ["security", "priority-critical"],
      "automerge": true,
      "prCreation": "immediate"
    }
  ],
  
  // Pull Request settings
  "prConcurrentLimit": 5,        // Max 5 PRs at once
  "prCreation": "immediate",     // Create PRs as soon as updates are found
  "prHourlyLimit": 0,            // No hourly limit
  "branchConcurrentLimit": 10,   // Max 10 branches at once
  
  // Commit message format
  "semanticCommits": "enabled",
  "commitMessagePrefix": "chore(deps):",
  "commitMessageAction": "update",
  "commitMessageTopic": "{{depName}}",
  "commitMessageExtra": "to {{newVersion}}",
  
  // Labels for PRs
  "labels": ["dependencies", "renovate"],
  
  // Assignees and reviewers (add Azure DevOps usernames)
  "assignees": [],
  "reviewers": [],
  
  // Version strategy
  "rangeStrategy": "bump",       // Update to exact version
  
  // Vulnerability alerts
  "vulnerabilityAlerts": {
    "enabled": true,
    "labels": ["security", "vulnerability"]
  },
  
  // Lock file maintenance
  "lockFileMaintenance": {
    "enabled": true,
    "schedule": ["before 6am on Monday"],
    "commitMessageAction": "refresh lock files"
  },
  
  // Azure DevOps specific
  "azureAutoComplete": false,    // Don't auto-complete PRs
  "azureWorkItemId": 0,          // Don't link to work items
  
  // Host rules for package registries
  "hostRules": [
    {
      "hostType": "nuget",
      "matchHost": "https://api.nuget.org"
    }
  ],
  
  // Scheduling (UTC timezone)
  "timezone": "UTC",
  
  // Ignore patterns (add packages you don't want updated)
  "ignoreDeps": [],
  "ignorePresets": []
}
